<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
<title type="text">Laurent's Research Page</title>
<generator uri="https://github.com/mojombo/jekyll">Jekyll</generator>
<link rel="self" type="application/atom+xml" href="/feed.xml" />
<link rel="alternate" type="text/html" href="" />
<updated>2015-06-09T00:44:24+02:00</updated>
<id>/</id>
<author>
  <name>Laurent Callot</name>
  <uri>/</uri>
  <email>lcallot@gmail.com</email>
</author>


<entry>
  <title type="html"><![CDATA[Une analyse textuelle des synopsis de 'Rendez-vous avec X']]></title>
  <link>/misc/rdvx</link>
  <id>/misc/rdvx</id>
  <published>2015-06-09T00:00:00+02:00</published>
  <updated>2015-06-09T00:00:00+02:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;h1 id=&quot;les-mots-des-titres-de-monsieur-x&quot;&gt;Les mots des titres de Monsieur X.&lt;/h1&gt;

&lt;p&gt;Le code utilisé pour créer les visualisations dans ce document est disponible dans son repo/&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;magrittr&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;SnowballC&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;wordcloud&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;RColorBrewer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;libs.R&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;les-titres&quot;&gt;Les titres&lt;/h2&gt;

&lt;p&gt;Deux grandes étapes:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Construction d’un corpus des titres, nettoyé autant que possible. &lt;/li&gt;
  &lt;li&gt;Création d’un nuage de mots des titres. &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;La création du corpus est présenté en détail plus bas dans le cas des synopsis.  &lt;/p&gt;

&lt;p&gt;Nuage de mots des titres.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-06-09-rdvx/title_cloud-1.png&quot; title=&quot;center&quot; alt=&quot;center&quot; width=&quot;\textwidth&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;recuperation-des-pisodes&quot;&gt;Recuperation des épisodes.&lt;/h2&gt;

&lt;p&gt;Un &lt;a href=&quot;http://rendezvousavecmrx.free.fr&quot;&gt;site non-officiel&lt;/a&gt; de rendez-vous avec X fournit une liste des épisodes avec synopsis pour les items 156 à 761. &lt;/p&gt;

&lt;p&gt;Une boucle sur les 606 épisodes pour lesquels un synopsis existe permet de récupérer pour chaque épisodes:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Une chaîne de caractères contenant la ou les dates de diffusion de l’épisode. &lt;/li&gt;
  &lt;li&gt;Le titre de l’épisode. &lt;/li&gt;
  &lt;li&gt;Le synopsis.
Ces données sont stocké dans une liste que est sauvé dans &lt;em&gt;rawdata_rdvX&lt;/em&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;GetRDVXSynop&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;les-synopsis&quot;&gt;Les synopsis.&lt;/h2&gt;

&lt;p&gt;J’utilise le packages &lt;em&gt;tm&lt;/em&gt; et en complément &lt;em&gt;SnowballC&lt;/em&gt; pour extraire le texte des synopsis, le transformer en corpus et nettoyer. Quelques librairies supplémentaires seront chargé en route. &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# create the corpus for the synopsis&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#raw_data[,3] &amp;lt;- gsub(&amp;#39;\&amp;#39;&amp;#39;,&amp;#39; &amp;#39;,raw_data[,3] )&lt;/span&gt;
vsource_synop &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; VectorSource&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;raw_data&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
corp_synop &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; Corpus&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;vsource_synop&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
corp_synop &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; clean_corpus&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;corp_synop&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;rm_common &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On commence par chercher les données brut. &lt;strong&gt;clean_corpus&lt;/strong&gt; nettoie et formate le corpus. Étapes du nettoyage du corpus:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Tout en minuscule.&lt;/li&gt;
  &lt;li&gt;Retirer les nombres.&lt;/li&gt;
  &lt;li&gt;Stemming et dé-stemming en utilisant la liste des 10000 mots les plus fréquent comme dictionnaire de complétion. &lt;/li&gt;
  &lt;li&gt;Retirer la ponctuation.&lt;/li&gt;
  &lt;li&gt;Retirer les stopwords français avec la liste de &lt;em&gt;tm&lt;/em&gt; + 2 autres listes + une courte liste fait main.&lt;/li&gt;
  &lt;li&gt;Retirer les 3500 mots les plus commun du français. &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;stemCompletion&lt;/em&gt; ne fonctionne pas avec le corpus des synopsis.   &lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Nous pouvons maintenant construire les nuage de mots en utilisant le packages &lt;em&gt;wordcloud&lt;/em&gt;, d’abord avec les synopsis: &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;wcloud&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;corp_synop&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;wlength &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;maxw &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;scale&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-06-09-rdvx/synop_cloud-1.png&quot; title=&quot;center&quot; alt=&quot;center&quot; width=&quot;\textwidth&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;correlations&quot;&gt;Correlations&lt;/h2&gt;

&lt;p&gt;On reprend le corpus des titres et pour quelques mots choisi j’affiche les 5 mots (de plus de 5 lettres) les plus fortement corrélé (en termes de présence) avec le mot choisi.&lt;/p&gt;

&lt;h3 id=&quot;correlations-dans-les-titres&quot;&gt;Correlations dans les titres&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dtm &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; DocumentTermMatrix&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;corp_title&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; control &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wordLengths &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;Inf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

findNassocs &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dtm&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;nassoc&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  mass &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;nassoc&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  y &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; findAssocs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dtm&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;corlimit&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;is.list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;)){&lt;/span&gt;mass&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;]][&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;nassoc&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;is.list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; mass&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;nassoc&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
  &lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mass&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; x
  &lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mass&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

tb &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; findNassocs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dtm&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;guerre&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;secrets&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;rouge&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;espion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;assassinat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; nassoc &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
kable&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tb&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;guerre&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;secrets&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;rouge&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;espion&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;assassinat&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bactériologique&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;israëlpalestine&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;fraction&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ariane&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;kadhafi&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;corée&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;britaniques&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;khmers&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;hernu&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;paolo&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;intox&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;cambodge&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;armée&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;krassilnikov&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;paris&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;froide&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;francoaméricaine&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;cambodge&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;maîtres&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;pasolini&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;civile&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;indochine&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;japonaise&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;parfait&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;renaud&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;putsch&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;révolution&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;armée&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;massacre&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;sahara&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;mercenaires&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;roumaine&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;fraction&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;melouza&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;implanté&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;equatoriale&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;culturelle&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;joseph&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;beach&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;alger&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;guinée&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orange&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;résistance&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;beslan&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;qaïda&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;brésil&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;cubaine&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;seigneur&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;émeutes&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;occidental&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;avril&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;morgan&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;rouge&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;harkis&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;guerre&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;chinois&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;alger&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;france&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;guinée&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;congo&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;culturelle&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bataille&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;otages&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;equatoriale&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;démocratique&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ambassade&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;putsh&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;allemands&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;mercenaires&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;république&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;belgrade&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sahara&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;pilotes&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;putsch&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;brazzaville&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;leung&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;guerre&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bosnie&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bissau&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;guerre&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;maîtres&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NA&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;espionnage&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;europe&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NA&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;correlations-dans-les-synopsis&quot;&gt;Correlations dans les synopsis.&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;terrorisme&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;attentats&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;communiste&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;espion&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;assassinat&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;baader&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;revendiqués&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;varsovie&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;taupe&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;avortée&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;affectés&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;animé&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;assorti&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;démasqué&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;fermons&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;agresser&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;artisanal&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;astreints&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;aéronautique&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;flingué&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;atomiquearrêtons&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;blessées&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bratislava&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;billion&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;focaliser&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;aucunement&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;champsélysées&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;caudines&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;briller&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;formulé&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;putsch&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;armée&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;massacre&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;nucléaire&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;république&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;aisance&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;andrei&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;indigènes&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;atome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;karadzic&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;anecdotes&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;andreïevitch&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bouchareb&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;prolifération&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sarajevo&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;antenne&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;brisés&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;consacrait&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;folamour&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;serbe&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;apparitions&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;commandées&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;émeuve&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;apprentis&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;serbes&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;applaudissements&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;décapitation&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;fêtait&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;appuiera&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;accablés&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;chine&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;afrique&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;france&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;israël&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;gaulle&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;pékin&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;colonies&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bailleur&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;hébreu&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;agacer&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;affrontant&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;eyadéma&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;légitimité&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;israéliens&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;blocs&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bloquer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;africaines&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;repoussoir&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;israélienne&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;convaincante&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;chenille&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;autorisaient&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;abritons&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;palestiniens&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;franche&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;colonne&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bilatéraux&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;amourhaine&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;benyamin&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;idéologies&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

  &lt;p&gt;&lt;a href=&quot;/misc/rdvx&quot;&gt;Une analyse textuelle des synopsis de 'Rendez-vous avec X'&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on June 09, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Regularized Estimation of Structural Instability in Factor Models: The US Macroeconomy and the Great Moderation.]]></title>
  <link>/papers/wp/ptv-fac</link>
  <id>/papers/wp/ptv-fac</id>
  <published>2015-06-01T00:00:00+02:00</published>
  <updated>2015-06-01T00:00:00+02:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;strong&gt;Submitted.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Download the paper &lt;a href=&quot;/papers/ptv-fac_WP.pdf&quot;&gt;pdf&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/lcallot/ptv-fac&quot;&gt;Replication material&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;abstract&quot;&gt;Abstract:&lt;/h2&gt;

&lt;p&gt;This paper shows that the parsimoniously time-varying methodology of &lt;a href=&quot;/wp/ptv-var&quot;&gt;Callot and Kristensen (2015)&lt;/a&gt; can be applied to factor models. We apply this method to study macroeconomic instability in the US from 1959:1 to 2006:4 with a particular focus on the Great Moderation. &lt;/p&gt;

&lt;p&gt;Models with parsimoniously time-varying parameters are models with an unknown number of break points at unknown locations. The parameters are assumed to follow a random walk with a positive probability that an increment is exactly equal to zero so that the parameters do not vary at every point in time. The vector of increments, which is high dimensional by construction and sparse by assumption, is estimated using the Lasso. &lt;/p&gt;

&lt;p&gt;We apply this method to the estimation of static factor models and factor augmented autoregressions using a set of 190 quarterly observations of 144 US macroeconomic series from Stock and Watson (2009). We find that the parameters of both models exhibit a higher degree of instability in the period from 1970:1 to 1984:4 relative to the following 15 years. In our setting the Great Moderation appears as the gradual ending of a period of high structural instability that took place in the 1970s and early 1980s.    &lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;/papers/wp/ptv-fac&quot;&gt;Regularized Estimation of Structural Instability in Factor Models: The US Macroeconomy and the Great Moderation.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on June 01, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Week 5:  Maximum Likelihood.]]></title>
  <link>/teaching/ie2015/w5/ie15/IE15-W5</link>
  <id>/teaching/ie2015/w5/ie15/IE15-W5</id>
  <published>2015-03-03T00:00:00+01:00</published>
  <updated>2015-03-03T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;This week we take a look at some numerical issues with maximum likelihood estimation.
  1. We take a look at the effect of the choice of starting value on the outcome of the a BFGS optmization.
  2. We look at the behaviour of the MLE of the parameter of a Bernoulli distribution when the sample size increases. We also look at the behaviour of test statistics.  &lt;/p&gt;

&lt;h2 id=&quot;local-extremum-and-starting-values&quot;&gt;Local extremum and starting values.&lt;/h2&gt;

&lt;p&gt;First we are going to look at the problems with functions having several local minima, and how the choice of starting value is critical in that case. We consider a function \( f(x) = -cos(x) - exp(-x^2) \) which has a global minimum at 0 and several local minima close to the points when \(x\) is a multiple of \( 2\pi \).&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Firs we load some libraries.&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;ggplot2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;reshape2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Define the likelihood function:&lt;/span&gt;
f &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Generate a set of (x,f(x)) for plotting&lt;/span&gt;
x &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
y &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; f&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plotting &lt;/span&gt;
xy &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
gxy &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xy&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_bw&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gxy&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-03-03-IE15-W5.rmd/local_ll.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;We are now going to try to numerically locate the value of \(x\) that minimizes \(f(.)\) for a set of starting values. That is, we try one starting value after another and see where the minimum is found, using a BFGS algorithm.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Define a set of starting values. &lt;/span&gt;
par_init &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# storage&lt;/span&gt;
pmat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;par_init&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
pmat&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; par_init
count &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Looping over the starting values. &lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;par &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; par_init&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
	count &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; count &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
	bf &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; optim&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;par&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;par&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;fn&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;f&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;method&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;BFGS&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	pmat&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; bf&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;par
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# preparing the data&lt;/span&gt;
pmat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;cbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pmat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;f&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pmat&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;f&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pmat&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pmat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;x_init&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;x_opt&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;y_init&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;y_opt&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

mi &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;pmat&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;pmat&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;iter&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;par_init&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
mi&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;type &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;initial&amp;#39;&lt;/span&gt;
mo &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;pmat&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;pmat&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;iter&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;par_init&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
mo&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;type &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;optimal&amp;#39;&lt;/span&gt;

mp &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;rbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mi&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;mo&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mp&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;iter &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mp&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;iter&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;	
	
&lt;span class=&quot;c1&quot;&gt;#plotting&lt;/span&gt;
gp &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;iter&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;gray80&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;xy&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_bw&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;type&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; scale_x_continuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;limits &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gp&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-03-03-IE15-W5.rmd/local_bfgs.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;The red-ish dots show the starting values, we try every value from -20 to 20 by steps of 0.5. the blue dots represtent the optimal value returned by BFGS. A grey line connects each inital value to its corresponding optimal value.&lt;/p&gt;

&lt;p&gt;There is far fewer blue than red dots, for many starting values the algorithm converges at the same point. The 7 blue dots in the figure correspond to the 6 local minima of the functions (x close to being a multiple of \( 2\pi \)) and the global miminum at \(x=0\).&lt;/p&gt;

&lt;p&gt;The most noticeable of the lines joining an initial value to its convergence value are those corresponding to pairs where we start far from the optimal and end up on it or the reverse: inital values close to the optimal value with convergence values far from 0. &lt;/p&gt;

&lt;h2 id=&quot;mle-and-tests-for-the-parameter-of-a-bernoulli-distribution-with-increasing-sample-size&quot;&gt;MLE and tests for the parameter of a Bernoulli distribution with increasing sample size.&lt;/h2&gt;

&lt;p&gt;This code is meant to allow you to replicate the plots at the end of the slides of week 5. You will not be able to replicate the exat plots since I forgot to fix the seed when generating them. Rookie mistake. &lt;/p&gt;

&lt;p&gt;First we create the function that will compute the LR, Wald, and LM test statistics for \(\mathcal H_0:p=p_0\) given a vector of realisations of the bernoulli random variable and an hypothesis to test.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Function to compute the 3 tests.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Input: the data vector X, the null hypothesis p0&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# output: a vector of length 3 with the 3 test statistics&lt;/span&gt;
Ltest&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;p0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	iT	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	LR	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;p0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;p0&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

	LM	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;iT&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(((&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;p0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;p0&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;p0&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;p0&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;iT&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

	W	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;iT&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;p0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;cbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;LR&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;LM&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;W&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Next we create the main loop function. At each iterations the sample is increased by one observation. We estimate \(\hat p \) and its variance and and call the previous function to compute the 3 test statistics. This function then formats the output for plotting.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;bernoulli &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;p&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;p0&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Initialization&lt;/span&gt;
X	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NULL&lt;/span&gt;
hp	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NULL&lt;/span&gt;
LLtest	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Estimation with increasing sample. &lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	xi	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;rbinom&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;p&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;	
	X	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;xi&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;hi	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;cbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
	&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;hi	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;cbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	hp	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;rbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;hp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;hi&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;Lt	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;Ltest&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;p0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;LLtest	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;rbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;LLtest&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;Lt&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# formatting&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;hp&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;p-hat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;est var&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mhp&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;hp&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# true parameter value and variance.&lt;/span&gt;
dfseg&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;p&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;p&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;p&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;Var2&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;p-hat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;est var&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# formatting the test stats&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;LLtest&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;LR&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;LM&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;W&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;LLtest&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;n
mLL		&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;LLtest&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;mle&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mhp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;trueval&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dfseg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;lltests&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mLL&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now we can run an experiment. All we need to do is choose values for \(p,p_0,n\) and plot the output. &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Setting the seed&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;set.seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;06011655&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# True parameter value, null hypothesis and sample size&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Modify these to replicate the different experiments in the slides. &lt;/span&gt;
p	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;
p0	&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;
n&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Critical value of the X2 distrib with 1df for 95% tests&lt;/span&gt;
X2cv &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; qchisq&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# running the XP&lt;/span&gt;
xp &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; bernoulli&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;p&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;p0&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#plotting the parameters&lt;/span&gt;
gghp&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xp&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;mle&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Var1&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;facet_grid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Var2&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;geom_line&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;geom_segment&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;xp&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;trueval&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;xend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;yend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;grey&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;theme_bw&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gghp&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-03-03-IE15-W5.rmd/bernoulli.xp.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# plotting the test stats&lt;/span&gt;
ggtest&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xp&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;lltests&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Var1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Var2&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;geom_line&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;facet_grid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Var2&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;scales&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;free_y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;geom_segment&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;xend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;X2cv&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;yend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;X2cv&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;theme_bw&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggtest&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-03-03-IE15-W5.rmd/bernoulli.xp.plot.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;/teaching/ie2015/w5/ie15/IE15-W5&quot;&gt;Week 5:  Maximum Likelihood.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on March 03, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Week 3:  Monte Carlos.]]></title>
  <link>/teaching/ie2015/w3/ie15/IE14-W3</link>
  <id>/teaching/ie2015/w3/ie15/IE14-W3</id>
  <published>2015-02-15T00:00:00+01:00</published>
  <updated>2015-02-15T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;This week we conduct some simulation experiments to investigate:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;The finite sample distribution of the OLS estimator in the case where the innovations are Gaussian or Student distributed. &lt;/li&gt;
  &lt;li&gt;The size and power of the t-test for varying sample sizes. &lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Loading the libraries. &lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;ggplot2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;reshape2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;plot3D&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;set.seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2512800&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;finite-sample-distribution-of-the-ols-estimator&quot;&gt;Finite sample distribution of the OLS estimator&lt;/h2&gt;

&lt;p&gt;In this section we conduct a series of simulation experiments to investigate the finite sample distribution of the ols estimator. Here are the steps we take:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;We build a function to perform the simulations. This function returns many estimates of \( \hat{\beta} \) when the data is generated with either Gaussian or Student distributed residuals. &lt;/li&gt;
  &lt;li&gt;We compare the empirical distributions of the estimators by plotting two overlapping histograms, one for each distribution.&lt;/li&gt;
  &lt;li&gt;We repeat the experiments with different numbers of observations and degrees of freedom. &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The simulation function computes many ols estimators on generated data where the residuals are either standard normal of t-distributed. The function takes as inputs the number of observations, of simulations, of control variables, and the number of degrees of freedom for the t-distribution of the innovations. It returns a list with the estimated parameters for the Gaussian and the t-residuals. For simplicity the true value of all entries of \( \hat{\beta} \) are equal to 1. In order to have the same variance for the Gaussian and Student residuals, we set the variance of the Gaussian innovations to \( \frac{tdf}{(tdf-2)} \) where \(tdf\) is the number of degrees of freedom of the Student innovations. &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#Let&amp;#39;s create a function returning the mc estimates of beta &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Inputs: - n the number of observations&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#         - mc the number of monte carlo iterations&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#         - k the number of control variables&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#         - tdf the degrees of freedom of the t distribution &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Output: - a list with two matrices of betaN and betaT.&lt;/span&gt;
mcbeta &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;tdf&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  

  &lt;span class=&quot;c1&quot;&gt;#storage matrix&lt;/span&gt;
  bN &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  bT &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
  &lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;m &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  	&lt;span class=&quot;c1&quot;&gt;# Set of controls&lt;/span&gt;
    X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
    epsN &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;sd&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tdf&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tdf&lt;span class=&quot;m&quot;&gt;-2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Gaussian innovations&lt;/span&gt;
    epsT &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Student innovations&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# the true beta is 1 in both cases&lt;/span&gt;
    yN &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; epsN
    yT &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; epsT
    
    &lt;span class=&quot;c1&quot;&gt;# Storing the estimated beta, discarding the constant&lt;/span&gt;
    bN&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; coef&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;yN &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    bT&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; coef&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;yT &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# returning a list with the results&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Normal&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;bN&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Student&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;bT&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now let’s run a first experiment with a very small sample of n=10 and plot the results as two overlapping histograms:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#nbr of obs&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#nbr of Monte Carlo iterations&lt;/span&gt;
mc &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# nbr of controls&lt;/span&gt;
k &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# degrees of freedom &lt;/span&gt;
tdf &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;

mc10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcbeta&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mc10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;iteration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;value&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;residuals&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mc10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;fill&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_histogram&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;binwidth&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; position&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;identity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-15-IE14-W3.rmd/mc10.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;\(\hat{\beta} \) is estimated to be somewhere between -2 and 3 when the innovations are &lt;em&gt;t(3)&lt;/em&gt;, while when they are &lt;em&gt;N(0,3)&lt;/em&gt; the range is around [0,2.5]. The &lt;em&gt;t&lt;/em&gt; distributed innovations produce many extreme estimates of \( \beta \). Because we seek to minimize the squared residuals, OLS is very sensitive to extreme observations.&lt;/p&gt;

&lt;p&gt;What happens when we increase the number of observations to 100?  &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#nbr of obs&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Estimation&lt;/span&gt;
mc100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcbeta&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mc100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;iteration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;value&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;residuals&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mc100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;fill&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_histogram&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;binwidth&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; position&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;identity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-15-IE14-W3.rmd/mc100.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;Both distributions are closer to the true value, but the &lt;em&gt;t&lt;/em&gt; distribution still produces many more outliers. Now with 1000 observations:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#nbr of obs&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Estimation&lt;/span&gt;
mc1000 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcbeta&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mc1000 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc1000&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc1000&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;iteration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;value&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;residuals&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mc1000 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc1000&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;fill&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_histogram&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;binwidth&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; position&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;identity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mc1000&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-15-IE14-W3.rmd/mc1000.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;With 1000 observations the distribution the two distributions are similar, in this case the normal approximation is good but we still have more extreme observations with the &lt;em&gt;t&lt;/em&gt; innovations.&lt;/p&gt;

&lt;p&gt;Let’s keep 1000 observation but increase the number of degrees of freedoms of the &lt;em&gt;t&lt;/em&gt; distributions so that it generates fewer extreme innovations:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#nbr of obs&lt;/span&gt;
tdf &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Estimation&lt;/span&gt;
mcdf10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcbeta&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mcdf10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcdf10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcdf10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;iteration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;value&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;residuals&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mcdf10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcdf10&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;fill&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_histogram&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;binwidth&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; position&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;identity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mcdf10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-15-IE14-W3.rmd/mcdf10.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;With 10 degrees of freedom, the two distributions are almost overlapping, the normal approximation is a good one in this case.&lt;/p&gt;

&lt;h2 id=&quot;size-and-power-of-the-t-test&quot;&gt;Size and power of the t-test.&lt;/h2&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#Let&amp;#39;s create a function returning the mc estimates of beta &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Inputs: - n the number of observations&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#         - mc the number of monte carlo iterations&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#         - k the number of control variables&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Output: &lt;/span&gt;
mcsp &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;# vector of values b for which we test H0: \hat\beta = b&lt;/span&gt;
  b &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;#storage matrix&lt;/span&gt;
  tstats &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tstats&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; b
  &lt;span class=&quot;c1&quot;&gt;# Looping over the number of iteratons &lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;m &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# We use a new set of controls for every experiment&lt;/span&gt;
    X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# standard normal innovations&lt;/span&gt;
    eps &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;sd&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# the true beta is 1 &lt;/span&gt;
    y &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; eps    
    &lt;span class=&quot;c1&quot;&gt;# Storing the estimated beta with std.err&lt;/span&gt;
    smy &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;coefficients
    &lt;span class=&quot;c1&quot;&gt;# Computing the vector of t-statistcs&lt;/span&gt;
    tstats&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;smy&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;smy&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# returning the vector of t-statistics.&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tstats&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In this first experiment we set n=100 and compute a 95\% t-test for the hypothesis \(\mathcal{H}_0:\hat\beta_i = b\) with b going from 0 to 1 (the true value) by steps of 0.01. We plot below the rejection frequency for each value of b.  &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#nbr of obs&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#nbr of Monte Carlo iterations&lt;/span&gt;
mc &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Critical value for the t-test&lt;/span&gt;
cv &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1.96&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# running the experiments&lt;/span&gt;
sp100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcsp&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

msp100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;colMeans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp100&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;cv&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
msp100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;cbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;as.numeric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp100&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;msp100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;msp100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;value&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.msp100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;msp100&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; 
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.msp100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-15-IE14-W3.rmd/ps100.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;We now repeat the same experiment as before for varying sample size. Each ribbon in the plot shows the rejection frequency for every value of b (y axis) at a given sample size (x axis). So the size of the test is the rejection frequency at b=1, it is always close to 0.05 the nominal value, and the rejection frequencies for b&amp;gt;1 are estimates of the power of the test for a given sample sizes. The power always starts close to 0.05 and climbs towards 1 while we move away from the true hypothesis. The climb is faster as the sample size increases: the more information the more often we reject false hypotheses.   &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#nbr of obs&lt;/span&gt;
b &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
vobs &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Storage&lt;/span&gt;
sp &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sp2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;vobs&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#nbr of Monte Carlo iterations&lt;/span&gt;
mc &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Critical value for the t-test&lt;/span&gt;
cv &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1.96&lt;/span&gt;
cv2&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; qt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.975&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;df&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;vobs&lt;span class=&quot;m&quot;&gt;-2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Looping over the sample sizes. &lt;/span&gt;
ncount &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; vobs&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
	ncount &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ncount &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;# running the experiments&lt;/span&gt;
	sp100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcsp&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	sp&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;ncount&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;colMeans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp100&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;cv&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
	sp2&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;ncount&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;colMeans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp100&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;cv2&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;ncount&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; b
&lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; vobs


ribbon3D&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;vobs&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;z &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; along &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; clab &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;rejection frequency&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; shade &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; bty &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;g&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ticktype &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;detailed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;phi&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;theta&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-110&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-15-IE14-W3.rmd/sp.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;Note that for the previous plot we used the quantile from the Gaussian distributions (i.e. from the asymptotic distribution of \(\mathcal{H}_0\)). In the plot below we use the exact Student critical values.  &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ribbon3D&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;vobs&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;z &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sp2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; along &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; clab &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;rejection frequency&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; shade &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; bty &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;g&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ticktype &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;detailed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;phi&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;theta&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-110&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-15-IE14-W3.rmd/sp2.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;/teaching/ie2015/w3/ie15/IE14-W3&quot;&gt;Week 3:  Monte Carlos.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on February 15, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Week 2: R-squared experiment, t-test, F-test .]]></title>
  <link>/teaching/ie2015/w2/ie15/IE15-W2</link>
  <id>/teaching/ie2015/w2/ie15/IE15-W2</id>
  <published>2015-02-10T00:00:00+01:00</published>
  <updated>2015-02-10T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;h3 id=&quot;restricted-regression-with-the-wage-data&quot;&gt;Restricted regression with the wage data.&lt;/h3&gt;

&lt;p&gt;First we load the data and check that it looks as expected. Make sure to adjust the path to the location of the data on your computer. &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Loading the data.&lt;/span&gt;
wage &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; read.csv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;../data/wages.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Printing the first rows of wage.&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wage&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##   X EXPER MALE SCHOOL  WAGE
## 1 1     9    0     13 6.315
## 2 2    12    0     12 5.480
## 3 3    11    0     11 3.642
## 4 4     9    0     14 4.593
## 5 5     8    0     14 2.418
## 6 6     9    0     14 2.094&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now we can regress &lt;em&gt;WAGE&lt;/em&gt; on &lt;em&gt;SCHOOL&lt;/em&gt; and &lt;em&gt;EXPER&lt;/em&gt; and &lt;em&gt;MALE&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# regression of wage on school and exper and male.&lt;/span&gt;
mod1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;WAGE &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; SCHOOL &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; EXPER &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; MALE&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;wage&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# printing the results of the regression.&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mod1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = WAGE ~ SCHOOL + EXPER + MALE, data = wage)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -7.65  -1.97  -0.46   1.44  34.19 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)  -3.3800     0.4650   -7.27  4.5e-13 ***
## SCHOOL        0.6388     0.0328   19.48  &amp;lt; 2e-16 ***
## EXPER         0.1248     0.0238    5.25  1.6e-07 ***
## MALE          1.3444     0.1077   12.49  &amp;lt; 2e-16 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 3.05 on 3290 degrees of freedom
## Multiple R-squared:  0.133,	Adjusted R-squared:  0.132 
## F-statistic:  168 on 3 and 3290 DF,  p-value: &amp;lt;2e-16&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To compute a restricted regression with \(\beta_{SCHOOL} = \beta_{EXPER}\) we define a new variable &lt;em&gt;XPSC&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;wage&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;XPSC &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; wage&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;EXPER &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; wage&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;SCHOOL
&lt;span class=&quot;c1&quot;&gt;# regression of wage on xpsc and male.&lt;/span&gt;
mod2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;WAGE &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; XPSC &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; MALE&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;wage&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# printing the results of the regression.&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mod2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = WAGE ~ XPSC + MALE, data = wage)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -6.60  -2.07  -0.48   1.52  33.05 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)   4.5085     0.1099   41.02   &amp;lt;2e-16 ***
## XPSC         -0.1555     0.0183   -8.51   &amp;lt;2e-16 ***
## MALE          1.3199     0.1125   11.73   &amp;lt;2e-16 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 3.18 on 3291 degrees of freedom
## Multiple R-squared:  0.0526,	Adjusted R-squared:  0.052 
## F-statistic: 91.4 on 2 and 3291 DF,  p-value: &amp;lt;2e-16&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#plotting library, install it if missing.&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;reshape2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Number of observations&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Number of replications&lt;/span&gt;
mciter &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# a vector with the number of control variables&lt;/span&gt;
k.all &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;from&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;to&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;by&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# storage initialization&lt;/span&gt;
r2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k.all&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;r2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; k.all
&lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;r2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;R2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;adjusted R2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
r2agg &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; r2

&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;j &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;mciter&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;# y is just white noise&lt;/span&gt;
	y &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;  &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;# a vector with the number of control variables&lt;/span&gt;
	k.all &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;from&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;to&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;by&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;# counter&lt;/span&gt;
	i &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;# looping over the numbers of controls.&lt;/span&gt;
	&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; k.all&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
	    &lt;span class=&quot;c1&quot;&gt;# creating the controls with a constant&lt;/span&gt;
	   X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;cbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;ifelse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;k&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))),&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;ifelse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;k&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
	    &lt;span class=&quot;c1&quot;&gt;# regression + computation of summary statistics&lt;/span&gt;
	    slm &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
	    &lt;span class=&quot;c1&quot;&gt;# Storage of the resuts&lt;/span&gt;
	    r2&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; slm&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;r.squared
	    r2&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; slm&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;adj.r.squared
	    &lt;span class=&quot;c1&quot;&gt;# increment the counter&lt;/span&gt;
	    i &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; i&lt;span class=&quot;m&quot;&gt;+1&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;#Storing the result of the first xp only.&lt;/span&gt;
	&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;j&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;mr2     &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;  melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;r2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;j&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mr2&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;  &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;r2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	
	&lt;span class=&quot;c1&quot;&gt;# aggregating the r2s&lt;/span&gt;
	 r2agg &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; r2agg &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; r2

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#formating the output&lt;/span&gt;
mr2agg    &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;  melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;r2agg&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;mciter&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mr2agg&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;r2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;warn &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# creating the plots &lt;/span&gt;
gr2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mr2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;r2&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
gr2agg &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mr2agg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;r2&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Plot of the first iteration:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gr2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-10-IE15-W2.rmd/plotgr2.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;Plot of the average over all iterations:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gr2agg&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-10-IE15-W2.rmd/plotgr2agg.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;/teaching/ie2015/w2/ie15/IE15-W2&quot;&gt;Week 2: R-squared experiment, t-test, F-test .&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on February 10, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Sharp threshold detection based on sup-norm error rates in high-dimensional models]]></title>
  <link>/papers/pub/threshold</link>
  <id>/papers/pub/threshold</id>
  <published>2015-02-09T00:00:00+01:00</published>
  <updated>2015-02-09T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;strong&gt;Accepted for publication: Journal of Business and Economic Statistics.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Download the paper &lt;a href=&quot;/papers/tlasso.pdf&quot;&gt;pdf&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/lcallot/ttlas&quot;&gt;Replication material&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;abstract&quot;&gt;Abstract:&lt;/h2&gt;

&lt;p&gt;We propose a new estimator, the thresholded scaled Lasso, in high dimensional threshold regressions. First, we establish an upper bound on the \( \ell_{\infty} \) estimation error of the scaled Lasso estimator of Lee et al. (2012). This is a non-trivial task as the literature on high-dimensional models has focused almost exclusively on \( \ell_1 \) and \( \ell_2\) estimation errors. We show that this sup-norm bound can be used to distinguish between zero and non-zero coefficients at a much finer scale than would have been possible using classical oracle inequalities. Thus, our sup-norm bound is tailored to consistent variable selection via thresholding.&lt;/p&gt;

&lt;p&gt;Our simulations show that thresholding the scaled Lasso yields substantial improvements in terms of variable selection. Finally, we use our estimator to shed further empirical light on the long running debate on the relationship between the level of debt (public and private) and GDP growth.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;/papers/pub/threshold&quot;&gt;Sharp threshold detection based on sup-norm error rates in high-dimensional models&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on February 09, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Week 1: Multiple Regressions and Matrix Notation.]]></title>
  <link>/teaching/ie2015/w1/ie15/IE15-W1</link>
  <id>/teaching/ie2015/w1/ie15/IE15-W1</id>
  <published>2015-02-04T00:00:00+01:00</published>
  <updated>2015-02-04T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;h1 id=&quot;regressions-with-multiple-variables-and-matrix-notation&quot;&gt;Regressions with multiple variables and matrix notation&lt;/h1&gt;

&lt;p&gt;This week we discussed:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Regressions with multiple variables.&lt;/li&gt;
  &lt;li&gt;The OLS in natrix notation.&lt;/li&gt;
  &lt;li&gt;Properties of the OLS  estimator.&lt;/li&gt;
  &lt;li&gt;Omitted variable bias.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This post will focus on:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Generating artificial data.&lt;/li&gt;
  &lt;li&gt;Use matrices in the code.&lt;/li&gt;
  &lt;li&gt;Estimate the OLS using built in functions&lt;/li&gt;
  &lt;li&gt;Manually estimate the OLS.&lt;/li&gt;
  &lt;li&gt;Calculate the parameters standard errors.&lt;/li&gt;
  &lt;li&gt;Plot the density of the residuals.&lt;/li&gt;
  &lt;li&gt;Load the wage data and compute regressions.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You can get help on any function by typing &lt;em&gt;?FunctionName&lt;/em&gt; in the &lt;em&gt;R&lt;/em&gt; console, try &lt;em&gt;?dim&lt;/em&gt; for example. &lt;/p&gt;

&lt;h3 id=&quot;multiple-regression-with-the-wage-data&quot;&gt;Multiple regression with the wage data.&lt;/h3&gt;

&lt;p&gt;First we load the data and check that it looks as expected.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Loading the data.&lt;/span&gt;
wage &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; read.csv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;../data/wages.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Printing the first rows of wage.&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wage&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##   X EXPER MALE SCHOOL  WAGE
## 1 1     9    0     13 6.315
## 2 2    12    0     12 5.480
## 3 3    11    0     11 3.642
## 4 4     9    0     14 4.593
## 5 5     8    0     14 2.418
## 6 6     9    0     14 2.094&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now we can regress &lt;em&gt;WAGE&lt;/em&gt; on &lt;em&gt;SCHOOL&lt;/em&gt; and &lt;em&gt;EXPER&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# regression of wage on school and exper.&lt;/span&gt;
mod1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;WAGE &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; SCHOOL &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; EXPER&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;wage&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# printing the results of the regression.&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mod1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = WAGE ~ SCHOOL + EXPER, data = wage)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -6.88  -1.99  -0.52   1.39  34.91 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)  -2.4767     0.4700   -5.27  1.5e-07 ***
## SCHOOL        0.5992     0.0334   17.94  &amp;lt; 2e-16 ***
## EXPER         0.1573     0.0242    6.51  8.9e-11 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 3.12 on 3291 degrees of freedom
## Multiple R-squared:  0.0915,	Adjusted R-squared:  0.0909 
## F-statistic:  166 on 2 and 3291 DF,  p-value: &amp;lt;2e-16&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;question&quot;&gt;Question:&lt;/h2&gt;
&lt;p&gt;Try estimating other models using different combination of variables.  &lt;/p&gt;

&lt;h3 id=&quot;transformations-of-the-data&quot;&gt;Transformations of the data&lt;/h3&gt;

&lt;p&gt;Maybe the number of years at school does not enter linearily in the model. We can expand the model with a quadratic term:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Create a variable with the square of the number of school years.&lt;/span&gt;
wage&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;SCHOOL2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; wage&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;SCHOOL&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Estimating the model and printing the results. &lt;/span&gt;
mod2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;WAGE &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; SCHOOL &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; SCHOOL2 &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; EXPER&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;wage&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mod2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = WAGE ~ SCHOOL + SCHOOL2 + EXPER, data = wage)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -7.33  -1.96  -0.51   1.38  34.97 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)   3.1149     1.5475    2.01  0.04421 *  
## SCHOOL       -0.3840     0.2614   -1.47  0.14201    
## SCHOOL2       0.0433     0.0114    3.79  0.00015 ***
## EXPER         0.1409     0.0245    5.75  9.8e-09 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 3.11 on 3290 degrees of freedom
## Multiple R-squared:  0.0954,	Adjusted R-squared:  0.0946 
## F-statistic:  116 on 3 and 3290 DF,  p-value: &amp;lt;2e-16&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;question-1&quot;&gt;Question:&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;Interpret the results above.&lt;/li&gt;
  &lt;li&gt;Maybe the number of years of schooling has a different effect for males and for females. How would you investigate this?  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;generating-data-following-a-regression-model-with-multiple-variables&quot;&gt;Generating data following a regression model with multiple variables&lt;/h3&gt;
&lt;p&gt;Let us assume the response variable &lt;em&gt;y&lt;/em&gt; follows a regression model with 3 explanatory variables:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
 
	\begin{aligned}
	y &amp; = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \epsilon \\
	y &amp; = (\iota,x_1,x_2,x_3)\beta + \epsilon \\
	y &amp; = X\beta + \epsilon
	\end{aligned}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;where \( \epsilon_i \sim \mathcal{N}(0,1)\), \( \iota \) is a vector of ones (&lt;em&gt;i.e.&lt;/em&gt; the constant), and \( \beta = (1,0.5,1,-1)’\) is the \(4\times 1\) vector of parameters.&lt;/p&gt;

&lt;p&gt;We want to generate data following this regression model with &lt;em&gt;k=3&lt;/em&gt; regressors (plus the constant) and &lt;em&gt;n=100&lt;/em&gt; observations. We generate a matrix &lt;em&gt;X&lt;/em&gt; of dimensions \(n\times k\) filled with random normal values. For that we need the following &lt;em&gt;R&lt;/em&gt; functions:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;matrix()&lt;/em&gt; to generate a matrix.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;rnrom()&lt;/em&gt; to generate \(\mathcal{N}(0,1)\) random numbers.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;dim()&lt;/em&gt; to print the dimensions of a matrix.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Choosing the seed&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;set.seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;666&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Setting up the number of variables and observations:&lt;/span&gt;
k &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Creating the matrix of regressors:&lt;/span&gt;
X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Creating the vector of parameters beta:&lt;/span&gt;
beta &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# printing the dimensions of X:&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 100   3&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We can now generate the variable &lt;em&gt;y&lt;/em&gt; using the matrix multiplication operator &lt;em&gt;%*%&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# First I generate the innovations:&lt;/span&gt;
eps &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Then y:&lt;/span&gt;
y &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; X&lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt;beta &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; eps

&lt;span class=&quot;c1&quot;&gt;# And check that the dimensions make sense&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 100   1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;estimating-beta-by-ols&quot;&gt;Estimating \(\beta\) by OLS&lt;/h3&gt;

&lt;p&gt;The generic function to estimate OLS in &lt;em&gt;R&lt;/em&gt; is called &lt;em&gt;lm()&lt;/em&gt;, notice that it automatically adds a constant to our model.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# estimate the model.&lt;/span&gt;
ols.lm &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# print the results. &lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ols.lm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = y ~ X)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -1.905 -0.626 -0.110  0.675  2.171 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)   0.9873     0.0987   10.00  &amp;lt; 2e-16 ***
## X1            0.4840     0.0972    4.98  2.8e-06 ***
## X2            1.2524     0.0881   14.21  &amp;lt; 2e-16 ***
## X3           -0.9078     0.0986   -9.20  7.6e-15 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 0.979 on 96 degrees of freedom
## Multiple R-squared:  0.78,	Adjusted R-squared:  0.773 
## F-statistic:  113 on 3 and 96 DF,  p-value: &amp;lt;2e-16&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The summary of the &lt;em&gt;lm()&lt;/em&gt; function shows many statistics that we will learn to understand throughout the course. If you try &lt;em&gt;plot(ols.lm)&lt;/em&gt; you will also get a number of useful plots, but… This is all too easy! &lt;/p&gt;

&lt;p&gt;It is more fun to code the OLS estimator ourselves. Remember the formula for the OLS estimator \(\hat{\beta}\) of \(\beta\) in matrix form: \(\hat{\beta}=\left(X’X\right)^{-1}X’y\). For that we need only two functions: &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The transpose function: &lt;em&gt;t()&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;The matrix inversion function &lt;em&gt;solve()&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We also need to remember adding a constant to X using the &lt;em&gt;cbind()&lt;/em&gt; function. &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Adding the constant&lt;/span&gt;
X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;cbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Estimating beta hat&lt;/span&gt;
beta.hat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt;y
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;beta.hat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##         [,1]
## [1,]  0.9873
## [2,]  0.4840
## [3,]  1.2524
## [4,] -0.9078&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The estimates of \(\hat{\beta}\) are the same using both methods, that is nice. &lt;/p&gt;

&lt;h2 id=&quot;question-2&quot;&gt;Question:&lt;/h2&gt;
&lt;p&gt;Compute the standard errors of the residuals and of the OLS estimator. To do this, you will need to:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Compute the OLS residuals:
    &lt;ul&gt;
      &lt;li&gt;compute the fit \( \hat{y}=X\hat{\beta} \),&lt;/li&gt;
      &lt;li&gt;compute the residuals \( \hat{\epsilon} = y - \hat{y} \). This should be a vector of the same length as &lt;em&gt;y&lt;/em&gt;.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Compute \(  \hat{\sigma}^2=\frac{\hat{\epsilon}’\hat{\epsilon}}{n-(k+1)}  \), to get the standard error you need to use the &lt;em&gt;sqrt()&lt;/em&gt; function on \(\hat{\sigma}^2\)&lt;/li&gt;
  &lt;li&gt;Get the individual standard errors:
    &lt;ul&gt;
      &lt;li&gt;Get the diagonal of \((X’X)^{-1}\) using &lt;em&gt;diag()&lt;/em&gt;.&lt;/li&gt;
      &lt;li&gt;Scale its square-root by \(\hat{\sigma}\). You should get a vector of standard errors of the same length as &lt;em&gt;beta.hat&lt;/em&gt;.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;To compare the output on your machine with the one in this post, make sure you have set the same seed as I have.&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Computing the residuals&lt;/span&gt;
y.hat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; X&lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt;beta.hat
e.hat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;y.hat

&lt;span class=&quot;c1&quot;&gt;# Residual standard error&lt;/span&gt;
sig2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;e.hat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt;e.hat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k&lt;span class=&quot;m&quot;&gt;+1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
res.se &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sig2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;\n residual standard errors:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; res.se&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;sep&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
##  residual standard errors:0.9785&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Parameter std. err.&lt;/span&gt;
diag.xx &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;diag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
beta.se &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; res.se &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;diag.xx&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;\n Parameters standard errors:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; beta.se&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;sep&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
##  Parameters standard errors:0.098690.097170.088130.09863&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;visualizing-the-results&quot;&gt;Visualizing the results.&lt;/h3&gt;

&lt;p&gt;Let evaluate the quality of our model graphically. To do that we can look at a scatter plot of the observed values and the residuals.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Creating a data frame with the resituals, and the observed and fitted values.&lt;/span&gt;
ols.man &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;residuals &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; e.hat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fitted &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; y.hat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; observed &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; y&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Loading a plotting library.&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
sqplot &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ols.man&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;observed&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sqplot&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-04-IE15-W1.rmd/fig-sq.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;we can also look at the density of our residuals.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;densplot &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ols.man&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_density&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;densplot&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2015-02-04-IE15-W1.rmd/fig-dens.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;h2 id=&quot;question-3&quot;&gt;Question:&lt;/h2&gt;

&lt;p&gt;Does this look like a Gaussian density to you? What happens when you re-run the code increasing the sample size &lt;em&gt;n&lt;/em&gt; to 1000?&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;/teaching/ie2015/w1/ie15/IE15-W1&quot;&gt;Week 1: Multiple Regressions and Matrix Notation.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on February 04, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Introductory Econometrics (Inleiding Econometrie 1) 2015]]></title>
  <link>/teaching/IE15.html</link>
  <id>/teaching/IE2015_main</id>
  <updated>2015-02-04T00:00:00-00:00</updated>
  <published>2015-01-27T00:00:00+01:00</published>
  
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;I will use this page to publish code allowing you to replicate the empirical and simulation results presented during the classes. 
All the code in these posts is &lt;em&gt;R&lt;/em&gt; code. &lt;em&gt;R&lt;/em&gt; allows me to easily share code with you, which you can run and modify. The simplest way to do that is:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Install &lt;a href=&quot;http://www.rstudio.com&quot;&gt;Rstudio&lt;/a&gt; (free, open source, compatible with all platform),&lt;/li&gt;
  &lt;li&gt;Copy/paste the pieces of code below in Rstudio’s console,&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;that’s it. &lt;/p&gt;

&lt;p&gt;These post also contains some computational questions. I encourage you to give these questions a try: if you really understand something, then you should be able to program it. Use whichever language/package you feel most comfortable with.    &lt;/p&gt;

&lt;p&gt;I have enabled comments. I encourage you to use those to ask questions and reply to open questions if you know the answer. The comments are anonymous and not necessarily linked to your &lt;em&gt;vu&lt;/em&gt; email, please keep it clean.  &lt;/p&gt;

&lt;article&gt;
&lt;h3&gt;&lt;a href=&quot;/teaching/ie2015/w5/ie15/IE15-W5&quot;&gt;Week 5:  Maximum Likelihood.&lt;/a&gt;&lt;/h3&gt;
&lt;!---&lt;span class=&quot;entry-date&quot;&gt;&lt;time datetime=&quot;2015-03-03T00:00:00+01:00&quot;&gt;March 2015&lt;/time&gt;&lt;/span&gt;--&gt;
&lt;/article&gt;

&lt;article&gt;
&lt;h3&gt;&lt;a href=&quot;/teaching/ie2015/w3/ie15/IE14-W3&quot;&gt;Week 3:  Monte Carlos.&lt;/a&gt;&lt;/h3&gt;
&lt;!---&lt;span class=&quot;entry-date&quot;&gt;&lt;time datetime=&quot;2015-02-15T00:00:00+01:00&quot;&gt;February 2015&lt;/time&gt;&lt;/span&gt;--&gt;
&lt;/article&gt;

&lt;article&gt;
&lt;h3&gt;&lt;a href=&quot;/teaching/ie2015/w2/ie15/IE15-W2&quot;&gt;Week 2: R-squared experiment, t-test, F-test .&lt;/a&gt;&lt;/h3&gt;
&lt;!---&lt;span class=&quot;entry-date&quot;&gt;&lt;time datetime=&quot;2015-02-10T00:00:00+01:00&quot;&gt;February 2015&lt;/time&gt;&lt;/span&gt;--&gt;
&lt;/article&gt;

&lt;article&gt;
&lt;h3&gt;&lt;a href=&quot;/teaching/ie2015/w1/ie15/IE15-W1&quot;&gt;Week 1: Multiple Regressions and Matrix Notation.&lt;/a&gt;&lt;/h3&gt;
&lt;!---&lt;span class=&quot;entry-date&quot;&gt;&lt;time datetime=&quot;2015-02-04T00:00:00+01:00&quot;&gt;February 2015&lt;/time&gt;&lt;/span&gt;--&gt;
&lt;/article&gt;


  &lt;p&gt;&lt;a href=&quot;/teaching/IE15.html&quot;&gt;Introductory Econometrics (Inleiding Econometrie 1) 2015&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on January 27, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Deterministic and stochastic trends in the Lee-Carter mortality model.]]></title>
  <link>/papers/wp/death</link>
  <id>/papers/wp/death</id>
  <published>2014-11-20T00:00:00+01:00</published>
  <updated>2014-11-20T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;strong&gt;Submitted.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Download the paper &lt;a href=&quot;/papers/death_wp.pdf&quot;&gt;pdf&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/lcallot/LeeCarter&quot;&gt;Replication material&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;abstract&quot;&gt;Abstract:&lt;/h2&gt;

&lt;p&gt;The Lee and Carter (1992) model assumes that the deterministic and stochastic time series dynamics loads with identical weights when describing the development of age specific mortality rates. Effectively this means that the main characteristics of the model simplifies to a random walk model with age specific drift components. But restricting the adjustment mechanism of the stochastic and linear trend components to be identical may be a too strong simplification. In fact, the presence of a stochastic trend component may itself result from a bias induced by properly fitting the linear trend that characterizes mortality data. We find empirical evidence that this feature
of the Lee-Carter model overly restricts the system dynamics and we suggest to separate the deterministic and stochastic time series components at the benefit of improved fit and forecasting performance. In fact, we find that the classical Lee-Carter model will otherwise over estimate the reduction of mortality for the younger age groups and will under estimate the reduction of mortality for
the older age groups. In practice, our recommendation means that the Lee-Carter model instead of a one-factor model should be formulated as a two (or several)-factor model where one factor is deterministic and the other factors are stochastic. This feature generalizes to the range of models that extend the Lee-Carter model in various directions.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;/papers/wp/death&quot;&gt;Deterministic and stochastic trends in the Lee-Carter mortality model.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on November 20, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Estimation and Forecasting of Large Realized Covariance Matrices and Portfolio Choice.]]></title>
  <link>/papers/wp/rcv-fc</link>
  <id>/papers/wp/rcv-fc</id>
  <published>2014-11-13T00:00:00+01:00</published>
  <updated>2014-11-13T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;strong&gt;Submitted.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Download the paper &lt;a href=&quot;/papers/rcv_forecasts.pdf&quot;&gt;pdf&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;abstract&quot;&gt;Abstract:&lt;/h2&gt;

&lt;p&gt;In this paper we consider modeling and forecasting of large realized covariance matrices by penalized vector autoregressive models. We propose using Lasso-type estimators to reduce the dimensionality to a manageable one and provide strong theoretical performance guarantees on the forecast capability of our procedure. To be precise, we show that we can forecast future realized covariance matrices almost as precisely as if we had known the true driving dynamics of these in advance. We next investigate the sources of these driving dynamics for the realized covariance matrices of the 30 Dow Jones stocks and find that these dynamics are not stable as the data is aggregated from the daily to the weekly and monthly frequency.&lt;/p&gt;

&lt;p&gt;The theoretical performance guarantees on our forecasts are illustrated on the Dow Jones index. In particular, we can beat our benchmark by a wide margin at the longer forecast horizons. Finally, we investigate the economic value of our forecasts in a portfolio selection exercise and find that in certain cases an investor is willing to pay a considerable amount in order get access to our forecasts.  &lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;/papers/wp/rcv-fc&quot;&gt;Estimation and Forecasting of Large Realized Covariance Matrices and Portfolio Choice.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on November 13, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Vector Autoregressions with Parsimoniously Time-Varying Parameters and an Application to Monetary Policy.]]></title>
  <link>/papers/wp/ptv-var</link>
  <id>/papers/wp/ptv-var</id>
  <published>2014-11-04T00:00:00+01:00</published>
  <updated>2014-11-04T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;strong&gt;Submitted.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Download the paper &lt;a href=&quot;/papers/ptv-var_WP_v2.pdf&quot;&gt;pdf&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/lcallot/ptv-var&quot;&gt;Replication material&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;abstract&quot;&gt;Abstract:&lt;/h2&gt;

&lt;p&gt;This paper studies vector autoregressive models with parsimoniously time-varying parameters. The parameters are assumed to follow parsimonious random walks, where parsimony stems from the assumption that increments to the parameters have a non-zero probability of being exactly equal to zero. We estimate the sparse and high-dimensional vector of changes to the parameters with the Lasso and the adaptive Lasso.&lt;/p&gt;

&lt;p&gt;The parsimonious random walk allows the parameters to be modelled non parametrically, so that our model can accommodate constant parameters, an unknown number of structural breaks, or parameters varying randomly. 
We characterize the finite sample properties of the Lasso by deriving upper bounds on the estimation and prediction errors that are valid with high probability, and provide asymptotic conditions under which these bounds tend to zero with probability tending to one. We also provide conditions under which the adaptive Lasso is able to achieve perfect model selection. &lt;/p&gt;

&lt;p&gt;We investigate by simulations the properties of the Lasso and the adaptive Lasso in settings where the parameters are stable, experience structural breaks, or follow a parsimonious random walk. &lt;br /&gt;
We use our model to investigate the monetary policy response to inflation and business cycle fluctuations in the US by estimating a parsimoniously time varying parameter Taylor rule. We document substantial changes in the policy response of the Fed in the 1970s and 1980s, and since 2007, but also document the stability of this response in the rest of the sample.    &lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;/papers/wp/ptv-var&quot;&gt;Vector Autoregressions with Parsimoniously Time-Varying Parameters and an Application to Monetary Policy.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on November 04, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Week 6: Empirical size and power of Likelihood based tests.]]></title>
  <link>/teaching/ie2014/w6/ie/IE14-W6</link>
  <id>/teaching/ie2014/w6/ie/IE14-W6</id>
  <published>2014-03-09T00:00:00+01:00</published>
  <updated>2014-03-09T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;h1 id=&quot;regressions-with-multiple-variables-and-matrix-notation&quot;&gt;Regressions with multiple variables and matrix notation&lt;/h1&gt;

&lt;h2 id=&quot;monte-carlo-estimation-of-the-size-and-power-of-likelihood-based-tests&quot;&gt;Monte Carlo estimation of the size and power of Likelihood based tests.&lt;/h2&gt;

&lt;p&gt;First, we create a function that takes as input a matrix X, the true value of beta2 as well as the number of observations and the number of Monte Carlo iterations. It returns a vector with the average rejection frequency of \(H0: \beta_2=0 \).&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;ggplot2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create a function returning mc p-values for each test Inputs: - n the&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# number of observations - mc the number of monte carlo iterations - b the&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# true value of beta2 - X the X matrix Output:&lt;/span&gt;
mcMLtests &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# The parameter vector&lt;/span&gt;
    beta &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# storage matrix&lt;/span&gt;
    LR &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    LM &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    W &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;m &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        eps &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; sd &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# standard normal innovations&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# Generating the data&lt;/span&gt;
        y &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; beta &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; eps
        
        &lt;span class=&quot;c1&quot;&gt;# Estimating the model under the alternative&lt;/span&gt;
        ML1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Under the Null&lt;/span&gt;
        ML0 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# Storing the residuals&lt;/span&gt;
        eps0 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; resid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ML0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        eps1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; resid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ML1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# Storing the estimated betas&lt;/span&gt;
        beta0 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; coef&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ML0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        beta1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; coef&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ML1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# Calculating the MLE of sigma2&lt;/span&gt;
        sig0 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;eps0&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;n
        sig1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;eps1&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;n
        
        &lt;span class=&quot;c1&quot;&gt;# Computing the test statistics:&lt;/span&gt;
        LR&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; n &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sig0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sig1&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        W&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;beta1&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sig1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
        LM&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;eps0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; eps0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;sig0
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    pval &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; pchisq&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;LM&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; df &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; pchisq&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;LR&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; df &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; 
        &lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; pchisq&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;W&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; df &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pval&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We use the function created above to run a first experiment with 10 observations (n=10). The true value of beta2 varies in the range \(\beta_2 = (0,0.05,0.1,…,0.95,1)\). &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# nbr of obs&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# nbr of Monte Carlo iterations&lt;/span&gt;
mc &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# beta2 parameter value&lt;/span&gt;
beta2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;from &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; to &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# The storage matrix&lt;/span&gt;
mc10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;beta2&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; beta2
&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;LM&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;LR&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;W&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Same set of controls for every experiment&lt;/span&gt;
X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# loop counter&lt;/span&gt;
i &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Monte Carlo experiment&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;b &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; beta2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    mc10&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcMLtests&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    i &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; i &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Now preparing a plot of the results:&lt;/span&gt;
mc10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##   Var1 Var2 value
## 1 0.00   LM 0.059
## 2 0.05   LM 0.083
## 3 0.10   LM 0.083
## 4 0.15   LM 0.089
## 5 0.20   LM 0.115
## 6 0.25   LM 0.132&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Test&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Power&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mc10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Power&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Test&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    ggtitle&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Rejection frequency of H0: beta2=0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2014-03-09-IE14-W6_rmd/mc10.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;Another experiment with 100 observations and \( \beta_2 =0,0.025,0.05,…,0.475,0.5 \):&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# nbr of obs&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# nbr of Monte Carlo iterations&lt;/span&gt;
mc &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# beta2 parameter value&lt;/span&gt;
beta2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;from &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; to &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.025&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# The storage matrix&lt;/span&gt;
mc100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;beta2&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; beta2
&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;LM&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;LR&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;W&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Same set of controls for every experiment&lt;/span&gt;
X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# loop counter&lt;/span&gt;
i &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Monte Carlo experiment&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;b &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; beta2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    mc100&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcMLtests&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    i &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; i &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Now preparing a plot of the results:&lt;/span&gt;
mc100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    Var1 Var2 value
## 1 0.000   LM 0.056
## 2 0.025   LM 0.068
## 3 0.050   LM 0.076
## 4 0.075   LM 0.116
## 5 0.100   LM 0.147
## 6 0.125   LM 0.198&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Test&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Power&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mc100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Power&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Test&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    ggtitle&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Rejection frequency of H0: beta2=0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2014-03-09-IE14-W6_rmd/mc100.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;Same experiment as before, but this time X is t-distributed with 3 degrees of freedom.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# The storage matrix&lt;/span&gt;
mc100X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;beta2&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; beta2
&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;LM&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;LR&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;W&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Same set of controls for every experiment&lt;/span&gt;
X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; df &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# loop counter&lt;/span&gt;
i &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Monte Carlo experiment&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;b &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; beta2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    mc100X&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcMLtests&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    i &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; i &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Now preparing a plot of the results:&lt;/span&gt;
mc100X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    Var1 Var2 value
## 1 0.000   LM 0.053
## 2 0.025   LM 0.070
## 3 0.050   LM 0.173
## 4 0.075   LM 0.317
## 5 0.100   LM 0.522
## 6 0.125   LM 0.686&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Test&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Power&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mc100X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100X&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Power&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Test&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    ggtitle&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Rejection frequency of H0: beta2=0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mc100X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2014-03-09-IE14-W6_rmd/mc100X.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;/teaching/ie2014/w6/ie/IE14-W6&quot;&gt;Week 6: Empirical size and power of Likelihood based tests.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on March 09, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Software on rdam and arhus.]]></title>
  <link>/misc/software-rdam</link>
  <id>/misc/software-rdam</id>
  <published>2014-03-04T00:00:00+01:00</published>
  <updated>2014-03-04T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;This page describes some useful Linux tools and statistical programs available on &lt;em&gt;rdam&lt;/em&gt; (and on &lt;em&gt;arhus&lt;/em&gt; in most instances). These are very short introductions, internet is full of more thorough discussion of each of the topics presented here.&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;

&lt;p&gt;&lt;em&gt;rdam&lt;/em&gt; and &lt;em&gt;arhus&lt;/em&gt; have no scheduler and no limits are imposed on the size and the duration of the jobs that users may submit. &lt;strong&gt;With great power comes great responsibility:&lt;/strong&gt; you are responsible for ensuring that your jobs do not overload the servers. Below I describe a couple of tools useful for doing that.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;screen&lt;/strong&gt;: Creates and manages virtual sessions that survive after you logout and can be resumed.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;top&lt;/strong&gt;: Monitor the server and user processes.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The main statistical packages available on &lt;em&gt;rdam&lt;/em&gt; are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;R&lt;/strong&gt;, &lt;strong&gt;Rstudio&lt;/strong&gt;, and &lt;strong&gt;Rstudio server&lt;/strong&gt;: Standard installation of &lt;em&gt;R&lt;/em&gt; and &lt;em&gt;Rstudio&lt;/em&gt; as well as a browser version of &lt;em&gt;Rstudio&lt;/em&gt; reachable through a SSH tunnel.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Matlab R2013b&lt;/strong&gt;: Standard installation with VU license.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Ox 7.00&lt;/strong&gt;: Installed so that &lt;em&gt;Ox&lt;/em&gt; runs by default on a single thread.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;linux-tools&quot;&gt;Linux tools&lt;/h1&gt;

&lt;h4 id=&quot;screen&quot;&gt;screen&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;To create a virtual session named &lt;em&gt;sname&lt;/em&gt; using screen enter &lt;code&gt;screen -S sname&lt;/code&gt;. This will result in a blank command prompt, you are in the virtual session. Any job you launch in this session will continue even after you log out.&lt;/li&gt;
  &lt;li&gt;To get back to the main session (detach the screen) type &lt;code&gt;Ctrl-A&lt;/code&gt; and then &lt;code&gt;d&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;To reattach a detached session by entering &lt;code&gt;screen -r sname&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;To kill the &lt;em&gt;sname&lt;/em&gt; session enter &lt;code&gt;exit&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;To list the existing screen sessions with their status &lt;code&gt;screen -ls&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;You can find much more detailed (and fancy) tutorials and tips &lt;a href=&quot;http://www.tecmint.com/screen-command-examples-to-manage-linux-terminals/&quot;&gt;here&lt;/a&gt; and &lt;a href=&quot;http://www.rackaid.com/blog/linux-screen-tutorial-and-how-to/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&quot;top&quot;&gt;top&lt;/h4&gt;

&lt;p&gt;&lt;em&gt;top&lt;/em&gt; is a useful monitoring tool. to access it, simply type &lt;code&gt;top&lt;/code&gt; at the command line. The first few lines that appear contain server wide statistics.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The third line shows the share of total cpu used for:
    &lt;ol&gt;
      &lt;li&gt;user processes&lt;/li&gt;
      &lt;li&gt;system&lt;/li&gt;
      &lt;li&gt;nice (low priority) processes&lt;/li&gt;
      &lt;li&gt;idle&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;The fourth line shows the total, used, and available memory.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Below comes a list of every process, starting with the process id and the user it belongs as well as memory use (RES) and cpu used (%CPU).&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Be extremely careful that the memory is not overloaded lest the server grinds to a halt.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;rdam&lt;/em&gt; has 16 physical cores and can run on up to 32 cores thanks to hyper-threading however performances are optimal when only 16 cores are used. Do not start large jobs when the server is already loaded, you have &lt;a href=&quot;/misc/computing-resources-VU&quot;&gt;other machines&lt;/a&gt; at your disposal.&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;software&quot;&gt;Software&lt;/h1&gt;

&lt;h4 id=&quot;r-rstudio-and-rstudio-server&quot;&gt;R, Rstudio, and Rstudio server&lt;/h4&gt;

&lt;p&gt;&lt;em&gt;R&lt;/em&gt; is started by simply typing &lt;code&gt;R&lt;/code&gt; at the command line.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.rstudio.com/&quot;&gt;&lt;em&gt;Rstudio&lt;/em&gt;&lt;/a&gt; provides a graphical user interface for &lt;em&gt;R&lt;/em&gt; as well as seamless integration with &lt;a href=&quot;http://yihui.name/knitr/&quot;&gt;knitr&lt;/a&gt; (great tool for reproducible research) and Git (and &lt;a href=&quot;https://github.com/&quot;&gt;Github&lt;/a&gt;, the host of this site) for version control (useful to keep track of code changes and for collaborative work)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Rstudio Server&lt;/em&gt; is also installed and &lt;em&gt;rdam&lt;/em&gt;. It provides an access to &lt;em&gt;Rstudio&lt;/em&gt; on &lt;em&gt;rdam&lt;/em&gt; in your browser through a SSH tunnel in two steps:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Open a terminal on your machine and enter: &lt;code&gt;ssh -f -N -L 1234:localhost:8787 VUNetID@rdam&lt;/code&gt;. After you enter your password nothing happens, the SSH tunnel is in the background. How to do this using PuTTY is described &lt;a href=&quot;http://jimhester.com/post/rstudio-server-through-ssh-tunnel&quot;&gt;here&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;Open a browser and point it to &lt;code&gt;localhost:1234&lt;/code&gt;, enter your VUNetID and password, and here you have &lt;em&gt;Rstudio&lt;/em&gt; running on &lt;em&gt;rdam&lt;/em&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;matlab&quot;&gt;Matlab&lt;/h4&gt;

&lt;p&gt;Matlab is installed with the latest stable release R2013b.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Start the GUI by typing &lt;code&gt;matlab&lt;/code&gt; at the command prompt.&lt;/li&gt;
  &lt;li&gt;To execute matlab scripts in the backgroup type &lt;code&gt;m myfile.m&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;ox-700&quot;&gt;Ox 7.00&lt;/h4&gt;

&lt;p&gt;Ox 7.00 is installed, usage is described on the website of &lt;a href=&quot;http://personal.vu.nl/c.s.bos/resources.html&quot;&gt;Charles Bos&lt;/a&gt;.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;/misc/software-rdam&quot;&gt;Software on rdam and arhus.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on March 04, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Computing resources at Econometrics and OR.]]></title>
  <link>/misc/computing-resources-VU</link>
  <id>/misc/computing-resources-VU</id>
  <published>2014-02-28T00:00:00+01:00</published>
  <updated>2014-02-28T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;

&lt;p&gt;Here is a brief overview of the machines readily accessible to members of the Econometrics &amp;amp; OR department. Modalities of access and usage of these machines is discussed below.  &lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Machine&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;Cores&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;Memory&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Remarks&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;em&gt;rdam&lt;/em&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;16 @2.9GHz&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;128GB&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Detailed user guide below.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;em&gt;arhus&lt;/em&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;8 @2.8GHz&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;12 GB&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Same as above.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;em&gt;pcoms001&lt;/em&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;12 @2.3GHz&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;128 GB&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Administered by the VU.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;em&gt;pcoms002&lt;/em&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;12 @2.3GHz&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;128 GB&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Same as above.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;em&gt;Lisa&lt;/em&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;6528 @2.2GHz&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;16TB&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Administered by Surf Sara.&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;pcoms0001-and-002&quot;&gt;pcoms0001 and 002&lt;/h1&gt;

&lt;p&gt;These machines are administered by the &lt;a href=&quot;https://vunet.login.vu.nl/services/pages/detail.aspx?cid=tcm%3a164-330191-16&quot;&gt;VU compute service&lt;/a&gt; and accessible from within the VU or through &lt;em&gt;rdam&lt;/em&gt; and &lt;em&gt;arhus&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;A user manual is provided here &lt;a href=&quot;https://vunet.login.vu.nl/_layouts/SharePoint.Tridion.WebParts/redirect.aspx?cid=tcm:164-327430-16&quot;&gt;(pdf)&lt;/a&gt;. These are essentially similar in software and specs to &lt;em&gt;rdam&lt;/em&gt; so also refer to the guide below. &lt;em&gt;Note that jobs lasting over 24 hours run the risk of being killed without sommations&lt;/em&gt;.&lt;/p&gt;

&lt;h1 id=&quot;lisa&quot;&gt;Lisa&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://www.surfsara.nl/systems/lisa/description&quot;&gt;Lisa&lt;/a&gt; is a cluster administered by &lt;a href=&quot;https://www.surfsara.nl&quot;&gt;Surf Sara&lt;/a&gt; (who also provide access to even larger systems) composed of about 500 nodes, each with 8 to 16 cores and 24GB to 32GB of memory. Usage is well &lt;a href=&quot;https://www.surfsara.nl/systems/lisa/usage&quot;&gt;documented here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Access to &lt;em&gt;Lisa&lt;/em&gt; is subject to a simple and fast &lt;a href=&quot;https://www.surfsara.nl/systems/lisa/account&quot;&gt;application process&lt;/a&gt; which needs to be supported (by email) by a faculty member with a permanent position.&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;rotterdam-and-arhus&quot;&gt;Rotterdam and Arhus&lt;/h1&gt;

&lt;p&gt;&lt;em&gt;Rotterdam&lt;/em&gt;, or &lt;em&gt;rdam&lt;/em&gt;, and &lt;em&gt;arhus&lt;/em&gt; are the names of the server financed by the Department of Econometrics &amp;amp; O.R., or NWO, at the VU University
Amsterdam. Members of the department can get an account from &lt;a href=&quot;mailto:l.callot@vu.nl&quot;&gt;Laurent Callot&lt;/a&gt; or &lt;a href=&quot;mailto:c.s.bos@vu.nl&quot;&gt;Charles
Bos&lt;/a&gt; who also maintain these machines.&lt;/p&gt;

&lt;h4 id=&quot;some-definitions&quot;&gt;Some definitions&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;rdam&lt;/em&gt; and &lt;em&gt;arhus&lt;/em&gt; are the machine for which you got an account.&lt;/li&gt;
  &lt;li&gt;They are known by IP address &lt;code&gt;145.108.238.26&lt;/code&gt; for rdam and &lt;code&gt;145.108.238.16&lt;/code&gt; for arhus. They are reachable
from outside the university as well, at these addresses.&lt;/li&gt;
  &lt;li&gt;You received your own login and password. Your login is personal, you
cannot give your password to anybody else.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;rdam&lt;/em&gt; contains a Tesla card, for GPU computations.&lt;/li&gt;
  &lt;li&gt;Each user has a limited amount of priority, e.g. if two users are working at the machine usually each is limited to 50% of the CPU-time if there is a conflict.&lt;/li&gt;
  &lt;li&gt;For the memory, there is no automatic limit. Please make sure you do not use too much memory, else the machine becomes very slow.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;entering-the-machine&quot;&gt;Entering the machine&lt;/h4&gt;

&lt;p&gt;If this is the first time you login, you will be asked to change your password.&lt;/p&gt;

&lt;h5 id=&quot;linux-unix-apple-stuff&quot;&gt;Linux, Unix, Apple stuff&lt;/h5&gt;
&lt;p&gt;To log onto &lt;em&gt;rdam&lt;/em&gt; start a terminal and enter &lt;code&gt;ssh VUnetID@145.108.238.26&lt;/code&gt;, you will be prompted for you password. To exit simply type &lt;code&gt;exit&lt;/code&gt;.  &lt;/p&gt;

&lt;h5 id=&quot;windows-machine&quot;&gt;Windows machine&lt;/h5&gt;
&lt;p&gt;You can enter the machine using a secure shell program, e.g. &lt;a href=&quot;http://www.chiark.greenend.org.uk/%7Esgtatham/putty/&quot;&gt;PuTTy&lt;/a&gt;. At the VU, send an email to &lt;a href=&quot;mailto:ucit-servicedesk@vu.nl&quot;&gt;ucit-servicedesk@vu.nl&lt;/a&gt; stating that you want access to PuTTY (if you don’t have it already).&lt;/p&gt;

&lt;p&gt;Start PuTTY, fill in as host name &lt;code&gt;145.108.238.26&lt;/code&gt; and save the session under the name &lt;em&gt;rdam&lt;/em&gt;, then hit the Open button. Fill in your login and password.  When you finish with PuTTY, type &lt;code&gt;exit&lt;/code&gt;, &lt;code&gt;ctrl-d&lt;/code&gt;, or just kill the window.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;/misc/computing-resources-VU&quot;&gt;Computing resources at Econometrics and OR.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on February 28, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Week 2-3: R squared, Testing, and Monte Carlo.]]></title>
  <link>/teaching/ie2014/w3/ie/IE14-W23</link>
  <id>/teaching/ie2014/w3/ie/IE14-W23</id>
  <published>2014-02-17T00:00:00+01:00</published>
  <updated>2014-02-17T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;h1 id=&quot;regressions-with-multiple-variables-and-matrix-notation&quot;&gt;Regressions with multiple variables and matrix notation&lt;/h1&gt;

&lt;p&gt;These last 2 weeks we discussed:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The R squared.&lt;/li&gt;
  &lt;li&gt;Test for linear restrictions.&lt;/li&gt;
  &lt;li&gt;Asymptotic properties of the OLS  estimator.&lt;/li&gt;
  &lt;li&gt;Omitted variable bias.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This post will focus on:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Estimate empirical distributions of the OLS estimator.&lt;/li&gt;
  &lt;li&gt;Investigate the finite sample size and power of tests. &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;r-squared-with-increasing-number-of-regressors&quot;&gt;R Squared with increasing number of regressors&lt;/h3&gt;

&lt;p&gt;Below the code used to generate the R squared plots in the homework slides of Week 2&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# loading the plotting library&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;ggplot2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# setting the seed&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;set.seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Number of observations&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# y is just white noise&lt;/span&gt;
y &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# a vector with the number of control variables&lt;/span&gt;
k.all &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;from &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; to &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# storage initialization&lt;/span&gt;
r2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k.all&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;r2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; k.all
&lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;r2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;R2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;adjusted R2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# counter&lt;/span&gt;
i &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# looping over the numbers of controls.&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; k.all&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# creating the controls with a constant&lt;/span&gt;
    
    X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;cbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;ifelse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; k &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))),&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;ifelse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; 
        &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; k &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# regression + computation of summary statistics&lt;/span&gt;
    slm &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Storage of the resuts&lt;/span&gt;
    r2&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; i&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; slm&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;r.squared
    r2&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; i&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; slm&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;adj.r.squared
    
    &lt;span class=&quot;c1&quot;&gt;# increment the counter&lt;/span&gt;
    i &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; i &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# plotting the results:&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# preparing the data&lt;/span&gt;
mr2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;r2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mr2&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;mesure&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;k&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plotting&lt;/span&gt;
gr2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mr2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mesure&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gr2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Warning: Removed 1 rows containing missing values (geom_path).&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2014-02-17-IE14-W23_rmd/plotr2.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;h2 id=&quot;finite-sample-distribution-of-the-ols-estimator&quot;&gt;Finite sample distribution of the OLS estimator&lt;/h2&gt;

&lt;p&gt;\( \hat{\beta} \) is normaly distruted if the residuals are Gaussian, but it is asymptotically normal under weaker assumptions. How good is the gaussian approximation? We evaluate this using a Monte Carlo experiment. &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Let&amp;#39;s create a function returning the mc estimates of beta Inputs: - n the&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# number of observations - mc the number of monte carlo iterations - k the&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# number of control variables - tdf the degrees of freedom of the t&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# distribution Output:&lt;/span&gt;
mcbeta &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# We use the same set of controls for every experiment&lt;/span&gt;
    X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# storage matrix&lt;/span&gt;
    bN &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    bT &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;m &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;mc&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        epsN &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; sd &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tdf&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tdf &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# standard normal innovations&lt;/span&gt;
        epsT &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#t(1) innovations&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# the true beta is 1 in both cases&lt;/span&gt;
        yN &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; epsN
        yT &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; epsT
        
        &lt;span class=&quot;c1&quot;&gt;# Storing the estimated beta, discarding the constant&lt;/span&gt;
        bN&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; coef&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;yN &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        bT&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; coef&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;yT &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# returning a list with the results&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Normal &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; bN&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Student &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; bT&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now let’s run a first experiment with a very small sample of n=10 and plot the results as two overlapping histograms:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# nbr of obs&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# nbr of Monte Carlo iterations&lt;/span&gt;
mc &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# nbr of controls&lt;/span&gt;
k &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# degrees of freedom&lt;/span&gt;
tdf &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;

mc10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcbeta&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mc10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;iteration&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;residuals&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mc10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc10&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_histogram&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;binwidth &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    alpha &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mc10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2014-02-17-IE14-W23_rmd/mc10.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;\(\hat{\beta} \) is estimated to be somewhere between -1 and 4 when the innovations are &lt;em&gt;t(3)&lt;/em&gt;, while when they are &lt;em&gt;N(0,3)&lt;/em&gt; the range is around [0,2.5]. The &lt;em&gt;t&lt;/em&gt; distributed innovations produce many extreme estimates of \( \beta \). Because we seek to minimize the squared residuals, OLS is very sensitive to extreme observations.&lt;/p&gt;

&lt;p&gt;What happens when we increase the number of observations to 100?  &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# nbr of obs&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;
mc100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcbeta&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mc100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;iteration&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;residuals&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mc100 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc100&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_histogram&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;binwidth &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    alpha &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mc100&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2014-02-17-IE14-W23_rmd/mc100.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;Both distributions are closer to the true value, but the &lt;em&gt;t&lt;/em&gt; distribution still produces many more outliers. Now with 1000 observations:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# nbr of obs&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;
mc1000 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcbeta&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mc1000 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc1000&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc1000&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;iteration&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;residuals&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mc1000 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mc1000&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_histogram&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;binwidth &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    alpha &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mc1000&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2014-02-17-IE14-W23_rmd/mc1000.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;With 1000 observations the distribution the two distributions are similar, in this case the normal approximation is good but we still have more extreme observations with the &lt;em&gt;t&lt;/em&gt; innovations.&lt;/p&gt;

&lt;p&gt;Let’s keep 1000 observation but increase the number of degrees of freedoms of the &lt;em&gt;t&lt;/em&gt; distributions so that it generates fewer extreme innovations:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# nbr of obs&lt;/span&gt;
tdf &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;

mcdf10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcbeta&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; tdf&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mcdf10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcdf10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;colnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcdf10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;iteration&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;residuals&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

gg.mcdf10 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcdf10&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_histogram&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;binwidth &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    alpha &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gg.mcdf10&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2014-02-17-IE14-W23_rmd/mcdf10.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;With 10 degrees of freedom, the two distributions are almost overlapping, the normal approximation is a good one in this case.&lt;/p&gt;

&lt;h2 id=&quot;question&quot;&gt;Question:&lt;/h2&gt;
&lt;p&gt;Can you setup a similar experiment to evaluate the size and the power of the &lt;em&gt;t&lt;/em&gt; test?&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;/teaching/ie2014/w3/ie/IE14-W23&quot;&gt;Week 2-3: R squared, Testing, and Monte Carlo.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on February 17, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Introductory Econometrics (inleiding econometrie 1) 2014]]></title>
  <link>/teaching/IE14.html</link>
  <id>/teaching/IE2014_main</id>
  <updated>2014-01-27T00:00:00-00:00</updated>
  <published>2014-01-27T00:00:00+01:00</published>
  
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;I will publish every week a post summarizing the material covered in the week with some extra questions and a focus on computing.&lt;/p&gt;

&lt;p&gt;All the code in these posts is &lt;em&gt;R&lt;/em&gt; code. &lt;em&gt;R&lt;/em&gt; allows me to easily share code with you, which you can run and modify. The simplest way to do that is:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Install &lt;a href=&quot;http://www.rstudio.com&quot;&gt;Rstudio&lt;/a&gt; (free, open source, compatible with all platform),&lt;/li&gt;
  &lt;li&gt;Copy/paste the pieces of code below in Rstudio’s console,&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;that’s it. &lt;/p&gt;

&lt;p&gt;These post also contains some computational questions. I encourage you to give these questions a try: if you really understand something, then you should be able to program it. Use whichever language/package you feel most comfortable with.    &lt;/p&gt;

&lt;p&gt;I have enabled comments. I encourage you to use those to ask questions and reply to open questions if you know the answer. The comments are anonymous and not necessarily linked to your &lt;em&gt;vu&lt;/em&gt; email, please keep it clean.  &lt;/p&gt;

&lt;article&gt;
&lt;h3&gt;&lt;a href=&quot;/teaching/ie2014/w6/ie/IE14-W6&quot;&gt;Week 6: Empirical size and power of Likelihood based tests.&lt;/a&gt;&lt;/h3&gt;
&lt;!---&lt;span class=&quot;entry-date&quot;&gt;&lt;time datetime=&quot;2014-03-09T00:00:00+01:00&quot;&gt;March 2014&lt;/time&gt;&lt;/span&gt;--&gt;
&lt;/article&gt;

&lt;article&gt;
&lt;h3&gt;&lt;a href=&quot;/teaching/ie2014/w3/ie/IE14-W23&quot;&gt;Week 2-3: R squared, Testing, and Monte Carlo.&lt;/a&gt;&lt;/h3&gt;
&lt;!---&lt;span class=&quot;entry-date&quot;&gt;&lt;time datetime=&quot;2014-02-17T00:00:00+01:00&quot;&gt;February 2014&lt;/time&gt;&lt;/span&gt;--&gt;
&lt;/article&gt;

&lt;article&gt;
&lt;h3&gt;&lt;a href=&quot;/teaching/ie2014/w1/ie/IE14-W1&quot;&gt;Week 1: Multiple Regressions and Matrix Notation.&lt;/a&gt;&lt;/h3&gt;
&lt;!---&lt;span class=&quot;entry-date&quot;&gt;&lt;time datetime=&quot;2014-01-27T00:00:00+01:00&quot;&gt;January 2014&lt;/time&gt;&lt;/span&gt;--&gt;
&lt;/article&gt;


  &lt;p&gt;&lt;a href=&quot;/teaching/IE14.html&quot;&gt;Introductory Econometrics (inleiding econometrie 1) 2014&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on January 27, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Week 1: Multiple Regressions and Matrix Notation.]]></title>
  <link>/teaching/ie2014/w1/ie/IE14-W1</link>
  <id>/teaching/ie2014/w1/ie/IE14-W1</id>
  <published>2014-01-27T00:00:00+01:00</published>
  <updated>2014-01-27T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;h1 id=&quot;regressions-with-multiple-variables-and-matrix-notation&quot;&gt;Regressions with multiple variables and matrix notation&lt;/h1&gt;

&lt;p&gt;This week we discussed:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Regressions with multiple variables.&lt;/li&gt;
  &lt;li&gt;The OLS in natrix notation.&lt;/li&gt;
  &lt;li&gt;Properties of the OLS  estimator.&lt;/li&gt;
  &lt;li&gt;Omitted variable bias.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This post will focus on:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Generating artificial data.&lt;/li&gt;
  &lt;li&gt;Use matrices in the code.&lt;/li&gt;
  &lt;li&gt;Estimate the OLS using built in functions&lt;/li&gt;
  &lt;li&gt;Manually estimate the OLS.&lt;/li&gt;
  &lt;li&gt;Calculate the parameters standard errors.&lt;/li&gt;
  &lt;li&gt;Plot the density of the residuals.&lt;/li&gt;
  &lt;li&gt;Load the wage data and compute regressions.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You can get help on any function by typing &lt;em&gt;?FunctionName&lt;/em&gt; in the &lt;em&gt;R&lt;/em&gt; console, try &lt;em&gt;?dim&lt;/em&gt; for example. &lt;/p&gt;

&lt;h3 id=&quot;generating-data-following-a-regression-model-with-multiple-variables&quot;&gt;Generating data following a regression model with multiple variables&lt;/h3&gt;
&lt;p&gt;Let us assume the response variable &lt;em&gt;y&lt;/em&gt; follows a regression model with 3 explanatory variables:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
 
	\begin{aligned}
	y &amp; = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \epsilon \\
	y &amp; = (\iota,x_1,x_2,x_3)\beta + \epsilon \\
	y &amp; = X\beta + \epsilon
	\end{aligned}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;where \( \epsilon_i \sim \mathcal{N}(0,1)\), \( \iota \) is a vector of ones (&lt;em&gt;i.e.&lt;/em&gt; the constant), and \( \beta = (1,0.5,1,-1)’\) is the \(4\times 1\) vector of parameters.&lt;/p&gt;

&lt;p&gt;We want to generate data following this regression model with &lt;em&gt;k=3&lt;/em&gt; regressors (plus the constant) and &lt;em&gt;n=100&lt;/em&gt; observations. We generate a matrix &lt;em&gt;X&lt;/em&gt; of dimensions \(n\times k\) filled with random normal values. For that we need the following &lt;em&gt;R&lt;/em&gt; functions:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;matrix()&lt;/em&gt; to generate a matrix.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;rnrom()&lt;/em&gt; to generate \(\mathcal{N}(0,1)\) random numbers.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;dim()&lt;/em&gt; to print the dimensions of a matrix.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Choosing the seed&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;set.seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;666&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Setting up the number of variables and observations:&lt;/span&gt;
k &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;
n &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Creating the matrix of regressors:&lt;/span&gt;
X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; k&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Creating the vector of parameters beta:&lt;/span&gt;
beta &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# printing the dimensions of X:&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 100   3&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We can now generate the variable &lt;em&gt;y&lt;/em&gt; using the matrix multiplication operator &lt;em&gt;%*%&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# First I generate the innovations:&lt;/span&gt;
eps &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Then y:&lt;/span&gt;
y &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; beta &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; eps

&lt;span class=&quot;c1&quot;&gt;# And check that the dimensions make sense&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 100   1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;estimating-beta-by-ols&quot;&gt;Estimating \(\beta\) by OLS&lt;/h3&gt;

&lt;p&gt;The generic function to estimate OLS in &lt;em&gt;R&lt;/em&gt; is called &lt;em&gt;lm()&lt;/em&gt;, notice that it automatically adds a constant to our model.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# estimate the model.&lt;/span&gt;
ols.lm &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# print the results.&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ols.lm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = y ~ X)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -1.905 -0.626 -0.110  0.675  2.171 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)   0.9873     0.0987   10.00  &amp;lt; 2e-16 ***
## X1            0.4840     0.0972    4.98  2.8e-06 ***
## X2            1.2524     0.0881   14.21  &amp;lt; 2e-16 ***
## X3           -0.9078     0.0986   -9.20  7.6e-15 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 0.979 on 96 degrees of freedom
## Multiple R-squared:  0.78,	Adjusted R-squared:  0.773 
## F-statistic:  113 on 3 and 96 DF,  p-value: &amp;lt;2e-16&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The summary of the &lt;em&gt;lm()&lt;/em&gt; function shows many statistics that we will learn to understand throughout the course. If you try &lt;em&gt;plot(ols.lm)&lt;/em&gt; you will also get a number of useful plots, but… This is all too easy! &lt;/p&gt;

&lt;p&gt;It is more fun to code the OLS estimator ourselves. Remember the formula for the OLS estimator \(\hat{\beta}\) of \(\beta\) in matrix form: \(\hat{\beta}=\left(X’X\right)^{-1}X’y\). For that we need only two functions: &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The transpose function: &lt;em&gt;t()&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;The matrix inversion function &lt;em&gt;solve()&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We also need to remember adding a constant to X using the &lt;em&gt;cbind()&lt;/em&gt; function. &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Adding the constant&lt;/span&gt;
X &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;cbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Estimating beta hat&lt;/span&gt;
beta.hat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; y
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;beta.hat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##         [,1]
## [1,]  0.9873
## [2,]  0.4840
## [3,]  1.2524
## [4,] -0.9078&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The estimates of \(\hat{\beta}\) are the same using both methods, that is nice. &lt;/p&gt;

&lt;h2 id=&quot;question&quot;&gt;Question:&lt;/h2&gt;
&lt;p&gt;Compute the standard errors of the residuals and of the OLS estimator. To do this, you will need to:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Compute the OLS residuals:
    &lt;ul&gt;
      &lt;li&gt;compute the fit \( \hat{y}=X\hat{\beta} \),&lt;/li&gt;
      &lt;li&gt;compute the residuals \( \hat{\epsilon} = y - \hat{y} \). This should be a vector of the same length as &lt;em&gt;y&lt;/em&gt;.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Compute \(  \hat{\sigma}^2=\frac{\hat{\epsilon}’\hat{\epsilon}}{n-(k+1)}  \), to get the standard error you need to use the &lt;em&gt;sqrt()&lt;/em&gt; function on \(\hat{\sigma}^2\)&lt;/li&gt;
  &lt;li&gt;Get the individual standard errors:
    &lt;ul&gt;
      &lt;li&gt;Get the diagonal of \((X’X)^{-1}\) using &lt;em&gt;diag()&lt;/em&gt;.&lt;/li&gt;
      &lt;li&gt;Scale its square-root by \(\hat{\sigma}\). You should get a vector of standard errors of the same length as &lt;em&gt;beta.hat&lt;/em&gt;.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;To compare the output on your machine with the one in this post, make sure you have set the same seed as I have.&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Computing the residuals&lt;/span&gt;
y.hat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; beta.hat
e.hat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; y.hat

&lt;span class=&quot;c1&quot;&gt;# Residual standard error&lt;/span&gt;
sig2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;e.hat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; e.hat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;k &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
res.se &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sig2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;\n residual standard errors:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; res.se&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; sep &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
##  residual standard errors:0.9785&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Parameter std. err.&lt;/span&gt;
diag.xx &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;diag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%*%&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
beta.se &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; res.se &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;diag.xx&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;\n Parameters standard errors:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; beta.se&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; sep &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
##  Parameters standard errors:0.098690.097170.088130.09863&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;visualizing-the-results&quot;&gt;Visualizing the results.&lt;/h3&gt;

&lt;p&gt;Let evaluate the quality of our model graphically. To do that we can look at a scatter plot of the observed values and the residuals.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Creating a data frame with the resituals, and the observed and fitted&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# values.&lt;/span&gt;
ols.man &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;residuals &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; e.hat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fitted &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; y.hat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; observed &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; y&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Loading a plotting library.&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
sqplot &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ols.man&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; observed&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sqplot&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2014-01-27-IE14-W1_rmd/fig-sq.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;p&gt;we can also look at the density of our residuals.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;densplot &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ols.man&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; residuals&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_density&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;densplot&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/figs/2014-01-27-IE14-W1_rmd/fig-dens.png&quot; alt=&quot;center&quot; /&gt; &lt;/p&gt;

&lt;h2 id=&quot;question-1&quot;&gt;Question:&lt;/h2&gt;

&lt;p&gt;Does this look like a Gaussian density to you? What happens when you re-run the code increasing the sample size &lt;em&gt;n&lt;/em&gt; to 1000?&lt;/p&gt;

&lt;h3 id=&quot;multiple-regression-with-the-wage-data&quot;&gt;Multiple regression with the wage data.&lt;/h3&gt;

&lt;p&gt;First we load the data and check that it looks as expected.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Loading the data.&lt;/span&gt;
wage &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; read.csv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;../data/wages.csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Printing the first rows of wage.&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wage&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##   X EXPER MALE SCHOOL  WAGE
## 1 1     9    0     13 6.315
## 2 2    12    0     12 5.480
## 3 3    11    0     11 3.642
## 4 4     9    0     14 4.593
## 5 5     8    0     14 2.418
## 6 6     9    0     14 2.094&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now we can regress &lt;em&gt;WAGE&lt;/em&gt; on &lt;em&gt;SCHOOL&lt;/em&gt; and &lt;em&gt;EXPER&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# regression of wage on school and exper.&lt;/span&gt;
mod1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;WAGE &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; SCHOOL &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; EXPER&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; wage&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# printing the results of the regression.&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mod1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = WAGE ~ SCHOOL + EXPER, data = wage)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -6.88  -1.99  -0.52   1.39  34.91 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)  -2.4767     0.4700   -5.27  1.5e-07 ***
## SCHOOL        0.5992     0.0334   17.94  &amp;lt; 2e-16 ***
## EXPER         0.1573     0.0242    6.51  8.9e-11 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 3.12 on 3291 degrees of freedom
## Multiple R-squared:  0.0915,	Adjusted R-squared:  0.0909 
## F-statistic:  166 on 2 and 3291 DF,  p-value: &amp;lt;2e-16&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;question-2&quot;&gt;Question:&lt;/h2&gt;
&lt;p&gt;Try estimating other models using different combination of variables.  &lt;/p&gt;

&lt;h3 id=&quot;transformations-of-the-data&quot;&gt;Transformations of the data&lt;/h3&gt;

&lt;p&gt;Maybe the number of years at school does not enter linearily in the model. We can expand the model with a quadratic term:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Create a variable with the square of the number of school years.&lt;/span&gt;
wage&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;SCHOOL2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; wage&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;SCHOOL&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Estimating the model and printing the results.&lt;/span&gt;
mod2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;WAGE &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; SCHOOL &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; SCHOOL2 &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; EXPER&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; wage&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mod2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = WAGE ~ SCHOOL + SCHOOL2 + EXPER, data = wage)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -7.33  -1.96  -0.51   1.38  34.97 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)   3.1149     1.5475    2.01  0.04421 *  
## SCHOOL       -0.3840     0.2614   -1.47  0.14201    
## SCHOOL2       0.0433     0.0114    3.79  0.00015 ***
## EXPER         0.1409     0.0245    5.75  9.8e-09 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 3.11 on 3290 degrees of freedom
## Multiple R-squared:  0.0954,	Adjusted R-squared:  0.0946 
## F-statistic:  116 on 3 and 3290 DF,  p-value: &amp;lt;2e-16&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;question-3&quot;&gt;Question:&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;Interpret the results above.&lt;/li&gt;
  &lt;li&gt;Maybe the number of years of schooling has a different effect for males and for females. How would you investigate this?  &lt;/li&gt;
&lt;/ol&gt;

  &lt;p&gt;&lt;a href=&quot;/teaching/ie2014/w1/ie/IE14-W1&quot;&gt;Week 1: Multiple Regressions and Matrix Notation.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on January 27, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Oracle inequalities for high dimensional vector autoregressions.]]></title>
  <link>/papers/pub/oracle-var</link>
  <id>/papers/pub/oracle-var</id>
  <published>2013-11-22T00:00:00+01:00</published>
  <updated>2013-11-22T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://www.sciencedirect.com/science/article/pii/S0304407615000378&quot;&gt;Journal of Econometrics Volume 186, Issue 2, June 2015 (link)&lt;/a&gt;.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Download the paper &lt;a href=&quot;/papers/oracle_var.pdf&quot;&gt;pdf&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;abstract&quot;&gt;Abstract:&lt;/h2&gt;

&lt;p&gt;This paper establishes non-asymptotic oracle inequalities for the prediction error and estimation accuracy of the LASSO in stationary vector autoregressive models. These inequalities are used to establish consistency of the LASSO even when the number of parameters is of a much larger order of magnitude than the sample size. We also give conditions under which no relevant variables are excluded. Next, non-asymptotic probabilities are given for the Adaptive LASSO to select the correct sparsity pattern. We then give conditions under which the Adaptive LASSO reveals the correct sparsity pattern asymptotically. We establish that the estimates of the non-zero coefficients are asymptotically equivalent to the oracle assisted least squares estimator. This is used to show that the rate of convergence of the estimates of the non-zero coefficients is identical to the one of least squares only including the relevant covariates.&lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;/papers/pub/oracle-var&quot;&gt;Oracle inequalities for high dimensional vector autoregressions.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on November 22, 2013.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Oracle Efficient estimation and Forecasting with the Adaptive Lasso and the Adaptive Group Lasso in Vector Autoregressions.]]></title>
  <link>/papers/pub/oracle-forecasting</link>
  <id>/papers/pub/oracle-forecasting</id>
  <published>2013-11-22T00:00:00+01:00</published>
  <updated>2013-11-22T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;strong&gt;Published as: Callot, Laurent A. F., and Anders Bredahl Kock, 2014, Oracle Efficient Estimation and Forecasting with the Adaptive Lasso and the Adaptive Group Lasso in Vector Autoregressions, in N. Haldrup, M. Meitz, and P. Saikkonen (eds.), Essays in Nonlinear Time Series Econometrics, Oxford University Press.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Download the paper &lt;a href=&quot;/papers/oracle_forecast.pdf&quot;&gt;pdf&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/lcallot/lasso-macro-forecast&quot;&gt;Replication material&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;abstract&quot;&gt;Abstract:&lt;/h2&gt;
&lt;p&gt;We show that the adaptive Lasso (aLasso) and the adaptive group Lasso (agLasso) are oracle efficient in stationary vector autoregressions where the number of parameters per equation is smaller than the number of observations. In particular, this means that the parameters are estimated consistently at a √T -rate, that the truly zero parameters are classified as such asymptotically and that the non-zero parameters are estimated as efficiently as if only the relevant variables had been included in the model from the outset. The group adaptive Lasso differs from the adaptive Lasso by dividing the covariates into groups whose members are all relevant or all irrelevant. Both estimators have the property that they perform variable selection and estimation in one step. We evaluate the forecasting accuracy of these estimators for a large set of macroeconomic variables. The plain Lasso is found to be the most precise procedure overall. The adaptive and the adaptive group Lasso are less stable but mostly perform at par with common factor models.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;/papers/pub/oracle-forecasting&quot;&gt;Oracle Efficient estimation and Forecasting with the Adaptive Lasso and the Adaptive Group Lasso in Vector Autoregressions.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on November 22, 2013.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Estimating and Testing for a Common Co-Integration Space in Large Panels of Co-Integrated VARs.]]></title>
  <link>/papers/wp/CCS</link>
  <id>/papers/wp/CCS</id>
  <published>2013-11-22T00:00:00+01:00</published>
  <updated>2013-11-22T00:00:00+01:00</updated>
  <author>
    <name>Laurent Callot</name>
    <uri></uri>
    <email>lcallot@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;Download the paper &lt;a href=&quot;/papers/pcvar_ccs.pdf&quot;&gt;pdf&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;abstract&quot;&gt;Abstract:&lt;/h2&gt;
&lt;p&gt;This paper proposes a maximum likelihood estimator for a common co-integration space in large panels of co-integrated Vector Autoregressive models. The method pioneered by Pesaran (2006) and further refined in Dees, Mauro, Pesaran, and Smith (2007) is used to reduce the dimension of the parameter space of the model and control for cross section dependence. The common co-integration space is estimated using standard optimization methods.. Test statistics for the existence of a common co-integration space against the hypothesis of heterogeneous co-integration spaces are derived. A bootstrap algorithm to generat pseudo data under the hypothesis of a common co-integration space is proposed, and bootstrap test statistics are derived. Identification of the co-integration vectors of the panel is also discussed.&lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;/papers/wp/CCS&quot;&gt;Estimating and Testing for a Common Co-Integration Space in Large Panels of Co-Integrated VARs.&lt;/a&gt; was originally published by Laurent Callot at &lt;a href=&quot;&quot;&gt;Laurent's Research Page&lt;/a&gt; on November 22, 2013.&lt;/p&gt;</content>
</entry>

</feed>
